
Installing Kubuntu 15.10 on Acer Aspire V Nitro Black Edition VN7-592G-757F
---------------------------------------------------------------------------

Download the latest Kubuntu:

  http://www.kubuntu.org/getkubuntu/

Check the SHA256 sum:

  sha256sum kubuntu-15.10-desktop-amd64.iso

Create an installation usb:

  sudo dd if=kubuntu-15.10-desktop-amd64.iso of=/dev/sdb
  
BIOS configuration (press F2 to enter the BIOS setup)
  
  Main menu:
   - Network Boot: Disabled
   - F12 Boot Menu: Enabled
   - Wake on Lan: Disabled
   - Touchpad: Basic
   - Lid Open Resume: Disabled
  
  Boot menu:
   - Boot Mode: UEFI
   - Secure Boot: Disabled
   
  Save and restart

Connect the usb. Reboot and press F12 to start the Boot Manager. Select the General USB Flash Disk.

In GRUB select 'Start Kubuntu', but first set the boot parameters pressing the 'e' letter.
We need to run GRUB with the boot option 'nomodeset'. Press ctr+x to continue with the boot.

Install Kubuntu following the default steps. Reboot if everything went fine.

Remove the USB when asked and press enter. If nothing happens simply reboot the laptop.

The boot will probably fail. We need to reboot and press F2 to enter the BIOS again.

Enable Secure Boot in the Boot menu. After that, in the Security menu enter the 
'Select an UEFI file as trusted for executing' menu. Select the grubx64.efi file and 
give it a name (e.g. Kubuntu). Disable Secure Boot again. Save and exit.

Luckily we will end up in GRUB (if not, press Esc to activate just after rebooting). 
We need to select Kubuntu and use the 'nomodeset' option.

Just after we login, we should remove the Bluetooth from the System Tray (inside System Tray 
Settings). It can create problems and freeze the screen.

The first thing to do is to install the linux kernel 4.3.4. This will solve many power 
management problems (be able to change the brightness, activate the sleep mode), that were
produced by the need of using the 'nomodeset' option in GRUB. 

  cd ~/admin
  mkdir kernel
  cd kernel
  mkdir 4.3.4
  cd 4.3.4
  wget http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.3.4-wily/linux-headers-4.3.4-040304_4.3.4-040304.201601230132_all.deb \
       http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.3.4-wily/linux-headers-4.3.4-040304-generic_4.3.4-040304.201601230132_amd64.deb \
       http://kernel.ubuntu.com/~kernel-ppa/mainline/v4.3.4-wily/linux-image-4.3.4-040304-generic_4.3.4-040304.201601230132_amd64.deb
  sudo dpkg -i linux-headers-4.3*.deb linux-image-4.3*.deb

Reboot the laptop. Kubuntu should start without problems, but in case we need to remove
the kernel, we can do the following:

  sudo aptitude purge linux-headers-4.3.4-040304 linux-headers-4.3.4-040304-generic linux-image-4.3.4-040304-generic

Next step is to make the wifi work. We need to do the following:

  mkdir ~/admin/wifiFirmware
  mkdir ~/admin/wifiFirmware/old
  sudo cp /lib/firmware/ath10k/QCA6174/hw3.0/* ~/admin/wifiFirmware/old/.
  sudo wget -O /lib/firmware/ath10k/QCA6174/hw3.0/board.bin https://github.com/FireWalkerX/ath10k-firmware/blob/7e56cbb94182a2fdab110cf5bfeded8fd1d44d30/QCA6174/hw3.0/board-2.bin?raw=true
  sudo wget -O /lib/firmware/ath10k/QCA6174/hw3.0/firmware-5.bin https://github.com/FireWalkerX/ath10k-firmware/blob/7e56cbb94182a2fdab110cf5bfeded8fd1d44d30/QCA6174/hw3.0/firmware-4.bin_WLAN.RM.2.0-00180-QCARMSWPZ-1?raw=true
  sudo chmod +x /lib/firmware/ath10k/QCA6174/hw3.0/*
  sudo cp /lib/firmware/ath10k/QCA6174/hw3.0/board.bin ~/admin/wifiFirmware/.
  sudo cp /lib/firmware/ath10k/QCA6174/hw3.0/firmware-5.bin ~/admin/wifiFirmware/.

The wifi should work after a reboot.

Now we can update the system:

  sudo apt-get install aptitude
  sudo aptitude update
  sudo aptitude dist-upgrade

Install some additional software:

  sudo aptitude install zile yakuake texlive texlive-lang-spanish r-base inkscape saods9 gv filezilla thunderbird vlc openshot kruler openjdk-8-jdk git
  sudo aptitude install python-scipy python3-scipy python-numpy python3-numpy python-matplotlib python3-matplotlib ipython ipython3
 
Install the NVIDIA drivers: System Settings > Driver Manager > NVIDIA binary driver - version 352.63

Make sure that we are using the intel GPU (The NVIDIA card has some problems with the sleep mode):

  sudo prime-select intel
  sudo update-grub

Reboot.

Install oracle java 7 and 8:

  sudo add-apt-repository ppa:webupd8team/java
  sudo aptitude update
  sudo aptitude install oracle-java7-installer 
  sudo aptitude install oracle-java8-installer

In case we want to remove the NVIDIA drivers, we should do the following:

  sudo aptitude purge nvidia-352
  sudo aptitude install xserver-xorg-video-nouveau

If we want to stop akonadi and mysql:

  akonadictl stop
  sudo service mysql status

Command to check software interrupts:

  grep . -r /sys/firmware/acpi/interrupts/

Useful links:

  https://notdefine.de/projects.php?project=Linux_on_Acer_Aspire_VN7-592G
  http://linuxdaddy.com/blog/install-kernel-4-3-on-ubuntu/
  https://bbs.archlinux.org/viewtopic.php?id=206517
  http://ubuntuforums.org/showthread.php?t=1613132
  http://www.webupd8.org/2012/09/install-oracle-java-8-in-ubuntu-via-ppa.html
  http://askubuntu.com/questions/176565/why-does-kworker-cpu-usage-get-so-high
  http://unix.stackexchange.com/questions/91027/how-to-disable-usb-autosuspend-on-kernel-3-7-10-or-above
